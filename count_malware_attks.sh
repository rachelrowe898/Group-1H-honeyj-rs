#!/bin/bash

if [ $# -ne 3 ]
then
  echo "Usage: $0 <directory of unzip/> <container code> <recording file path>"
  exit 1
fi

unzippedDir="$1"
container_code="$2"
recordFile="$3"
attk_ID=1
count=0

parentDir=${unzippedDir}${container_code}_${attk_ID}
while [ -d $parentDir ] ; do
  active_data_name=$(ls ${unzippedDir}${container_code}_${attk_ID})

  if [ "$active_data_name" != "" ]
  then
    subDir=${unzippedDir}${container_code}_${attk_ID}/${active_data_name}

    numFiles=$(ls ${subDir} | wc -l)
    if [ $numFiles -gt 1 ]
    then
      echo ${subDir} >> ${recordFile}
    fi
  fi
  # update var for next:
  attk_ID=$(( $attk_ID + 1 ))

  parentDir=${unzippedDir}${container_code}_${attk_ID}
done

attk_ID=$(( $attk_ID - 1 ))
echo "Last read: ${container_code}_${attk_ID}"
